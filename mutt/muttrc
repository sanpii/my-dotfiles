# General {{{

source ~/.mutt/colors.`tty -s && tput colors || echo 8`

set editor="vim"
set sort=threads

set from="sanpi@homecomputing.fr"
alternates nicolas.joseph@valaide.org nicolas.joseph@homecomputing.fr gege2061@homecomputing.fr
set reverse_name
set use_from=yes
set envelope_from="yes"
set realname="Nicolas"
set edit_headers
set pager_stop
set pager_index_lines=10

set collapse_unread=no

set date_format="%d/%m/%y à %H:%M"
set attribution="Le %d, %n a écrit :"
set folder_format="%4C [%t%N] %f %> %t %8s %d"
set index_format="%4C [%Z] %-15.15L %?y?(%.20Y) ?%s %> %D"

set crypt_autosign=yes
set crypt_replyencrypt=yes

set fast_reply

folder-hook . "exec collapse-all"
# }}}
# Header {{{
unignore X-Label
unignore X-Troll
unignore X-URL

hdr_order Date From To CC BCC User-Agent Subject X-Label X-Troll
my_hdr X-URL: http://sanpi.homecomputing.fr
# }}}
# Maildir {{{
set mbox_type=Maildir

set spoolfile="~/Maildir/INBOX"
set folder="~/Maildir/"
set mask="^[A-Z]"
set record="+Sent"
set postponed="+Drafts"
set certificate_file=~/Maildir/certs

mailboxes `cd /home/sanpi/Maildir; find . '(' -type d '(' -name 'cur' -o -name 'new' ')' -prune -printf '"%h"\n' ')' | sort -u | sed 's/\".\//="/' | tr '\n' ' '`

macro index c "<change-folder>?<toggle-mailboxes>" "open a different folder"
macro pager c "<change-folder>?<toggle-mailboxes>" "open a different folder"

macro index C "<copy-message>?<toggle-mailboxes>" "copy a message to a mailbox"
macro index M "<save-message>?<toggle-mailboxes>" "move a message to a mailbox"

# Reduce polling frequency to a sane level
set mail_check=5
set timeout=10

# keep a cache of headers for faster loading (1.5.9+?)
set header_cache=~/Maildir/.hcache
# }}}
# Sidebar {{{
set sidebar_delim = ' '
set sidebar_visible = yes
set sidebar_width = 32

color sidebar_new brightyellow default
# }}}
# bindings {{{
bind browser,attach t next-entry
bind browser,attach s previous-entry
bind index t next-undeleted
bind index s previous-undeleted
bind generic,index,browser T next-entry
bind generic,index,browser S previous-entry
bind pager t next-line
bind pager s previous-line
bind index,attach j tag-entry
bind index J tag-pattern
bind index ^J untag-pattern
bind index <Esc>j tag-thread
bind pager,index k save-message
bind attach,pager c exit
bind browser c previous-page
macro index c "y"
bind browser r select-entry
bind index r display-message
bind pager r view-attachments
bind attach r view-attach
bind attach k save-entry
bind index,pager,attach , reply

bind pager / search
bind pager gg top
bind pager G bottom
macro index za '<esc>v'
macro index zr '<esc>V'
macro index zm '<esc>V'

bind index gg first-entry
bind index G last-entry
macro pager za '<esc>v'
macro pager zr '<esc>V'
macro pager zm '<esc>V'

bind index <pagedown>  next-page
bind index <pageup> previous-page
bind index,pager R group-reply

bind index,pager \Cs sidebar-prev
bind index,pager \Ct sidebar-next
bind index,pager \Cr sidebar-open
# }}}
# Labels {{{
# }}}
# Trash {{{
folder-hook . 'macro index,pager d "<save-message>=Trash<enter><enter>"  "Mark message as trash"'
folder-hook 'Junk|Trash|RSS' 'bind index,pager d delete-message'
#}}}
# Spam {{{
macro index,pager \ed "<enter-command>unset wait_key\n<pipe-entry>sa-learn --spam\n<enter-command>set wait_key\n<save-message>=Junk\n" "Tags a given message as SPAM"
macro index,pager \eu "<pipe-entry>sa-learn --ham\n<enter-command>set wait_key\n<save-message>=INBOX\n" "Untags a given message as SPAM"
macro index \et "<pipe-entry>spamassassin -t\n<enter-command>set wait_key\n" "Tests a given message to see if it is SPAM"
# }}}
# Mime types {{{
auto_view text/html
# }}}

